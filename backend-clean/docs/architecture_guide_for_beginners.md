# ğŸ›ï¸ ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å…¥é–€ã‚¬ã‚¤ãƒ‰ - æœ¬å½“ã«ã‚¼ãƒ­ã‹ã‚‰ç†è§£ã™ã‚‹

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ã€**å°å­¦ç”Ÿã§ã‚‚ã‚ã‹ã‚‹**ã‚’ã‚³ãƒ³ã‚»ãƒ—ãƒˆã«ã€ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’å®Ÿä¾‹ã¨ã¨ã‚‚ã«è§£èª¬ã—ã¾ã™ã€‚

ã€Œé›£ã—ãã†â€¦ã€ã¨æ€ã£ãŸäººã€å®‰å¿ƒã—ã¦ãã ã•ã„ã€‚ã“ã®ã‚¬ã‚¤ãƒ‰ã‚’èª­ã‚ã°ã€**ãªãœã“ã†è¨­è¨ˆã™ã‚‹ã®ã‹**ã€**ã©ã“ã«ä½•ã‚’æ›¸ã‘ã°ã„ã„ã®ã‹**ãŒæ‰‹ã«å–ã‚‹ã‚ˆã†ã«ã‚ã‹ã‚Šã¾ã™ã€‚

---

## ğŸ“š ç›®æ¬¡

1. [ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã£ã¦ä½•ï¼Ÿ](#ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã£ã¦ä½•)
2. [æœ€ã‚‚å¤§åˆ‡ãª3ã¤ã®ãƒ«ãƒ¼ãƒ«](#æœ€ã‚‚å¤§åˆ‡ãª3ã¤ã®ãƒ«ãƒ¼ãƒ«)
3. [å®¶ã¥ãã‚Šã§ç†è§£ã™ã‚‹ãƒ¬ã‚¤ãƒ¤ãƒ¼æ§‹é€ ](#å®¶ã¥ãã‚Šã§ç†è§£ã™ã‚‹ãƒ¬ã‚¤ãƒ¤ãƒ¼æ§‹é€ )
4. [ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å†’é™º - ãƒ‡ãƒ¼ã‚¿ã®æµã‚Œã‚’è¿½ã†](#ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å†’é™º---ãƒ‡ãƒ¼ã‚¿ã®æµã‚Œã‚’è¿½ã†)
5. [å„ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®è©³ç´°è§£èª¬](#å„ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®è©³ç´°è§£èª¬)
6. [å®Ÿä¾‹ã§å­¦ã¶: ãƒãƒ¼ãƒˆä½œæˆæ©Ÿèƒ½](#å®Ÿä¾‹ã§å­¦ã¶-ãƒãƒ¼ãƒˆä½œæˆæ©Ÿèƒ½)
7. [ã‚ˆãã‚ã‚‹è³ªå•ã¨ç­”ãˆ](#ã‚ˆãã‚ã‚‹è³ªå•ã¨ç­”ãˆ)
8. [ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ: ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãå‰ã«](#ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ-ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãå‰ã«)

---

## ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã£ã¦ä½•ï¼Ÿ

ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¯ã€**ã€Œå¤‰ã‚ã‚‹ã‚‚ã®ã€ã¨ã€Œå¤‰ã‚ã‚‰ãªã„ã‚‚ã®ã€ã‚’åˆ†ã‘ã‚‹è¨­è¨ˆæ‰‹æ³•**ã§ã™ã€‚

### ãªãœå¿…è¦ãªã®ï¼Ÿ

æƒ³åƒã—ã¦ã¿ã¦ãã ã•ã„ã€‚ã‚ãªãŸãŒãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ã®ã‚ªãƒ¼ãƒŠãƒ¼ã ã¨ã—ã¾ã™ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ• ãƒ”ã‚¶ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³                        â”‚
â”‚                                         â”‚
â”‚  âŒ æ‚ªã„è¨­è¨ˆï¼š                            â”‚
â”‚  - ã‚­ãƒƒãƒãƒ³ã§æ³¨æ–‡ã‚‚å—ã‘ã‚‹                 â”‚
â”‚  - ãƒ¬ã‚¸ã§æ–™ç†ã‚‚ä½œã‚‹                       â”‚
â”‚  - ã‚¦ã‚§ã‚¤ã‚¿ãƒ¼ãŒãƒ¬ã‚·ãƒ”ã‚’æ±ºã‚ã‚‹             â”‚
â”‚  â†’ æ··æ²Œï¼èª°ãŒä½•ã‚’ã‚„ã‚‹ã‹ã‚ã‹ã‚‰ãªã„ï¼        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ• ãƒ”ã‚¶ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³                        â”‚
â”‚                                         â”‚
â”‚  âœ… è‰¯ã„è¨­è¨ˆï¼š                            â”‚
â”‚  - ãƒ›ãƒ¼ãƒ«: ãŠå®¢ã•ã‚“ã‹ã‚‰æ³¨æ–‡ã‚’å—ã‘ã‚‹        â”‚
â”‚  - ã‚­ãƒƒãƒãƒ³: ãƒ¬ã‚·ãƒ”ã«å¾“ã£ã¦æ–™ç†ã‚’ä½œã‚‹      â”‚
â”‚  - ãƒ¬ã‚¸: ãŠä¼šè¨ˆã‚’å‡¦ç†ã™ã‚‹                 â”‚
â”‚  â†’ å½¹å‰²ãŒæ˜ç¢ºï¼å¤‰æ›´ã‚‚ç°¡å˜ï¼               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¯ã€**ã‚·ã‚¹ãƒ†ãƒ ã‚’ã€Œå½¹å‰²ã”ã¨ã®éƒ¨å±‹ã€ã«åˆ†ã‘ã‚‹**è¨­è¨ˆã§ã™ã€‚

---

## æœ€ã‚‚å¤§åˆ‡ãª3ã¤ã®ãƒ«ãƒ¼ãƒ«

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ã€3ã¤ã®ã‚·ãƒ³ãƒ—ãƒ«ãªãƒ«ãƒ¼ãƒ«ã‚’å®ˆã‚‹ã ã‘ã§OKã§ã™ã€‚

### ğŸ“Œ ãƒ«ãƒ¼ãƒ«1: ä¾å­˜ã¯å†…å‘ãã ã‘

```
å¤–å´ã®ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¯å†…å´ã‚’çŸ¥ã£ã¦OK
å†…å´ã®ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¯å¤–å´ã‚’çŸ¥ã£ã¡ã‚ƒãƒ€ãƒ¡

      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚   å¤–å´      â”‚ â”€â”€â”
      â”‚ (Controller)â”‚   â”‚ OK: å†…å´ã‚’çŸ¥ã£ã¦ã‚‹
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â†“
            â”‚
            â†“
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚   å†…å´      â”‚   Ã—  NG: å¤–å´ã‚’çŸ¥ã‚‰ãªã„
      â”‚  (UseCase)  â”‚      (å¤–ã«çŸ¢å°ãŒå‡ºãªã„)
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å…·ä½“ä¾‹ï¼š**
- âœ… Controller ãŒ UseCase ã‚’å‘¼ã¶ â†’ OK
- âŒ UseCase ãŒ Controller ã‚’å‘¼ã¶ â†’ NG
- âœ… Gateway ãŒ Domain ã®å‹ã‚’ä½¿ã† â†’ OK
- âŒ Domain ãŒ PostgreSQL ã®å‹ã‚’ä½¿ã† â†’ NG

### ğŸ“Œ ãƒ«ãƒ¼ãƒ«2: ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã‚’è·¨ãã¨ãã¯å¤‰æ›ã™ã‚‹

```
HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆ â†’ ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ« â†’ DBã®è¡Œ

ãã‚Œãã‚Œåˆ¥ã®å‹ï¼å¤‰æ›ãŒå¿…è¦ï¼

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  å¤‰æ›   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  å¤‰æ›   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ HTTP JSON    â”‚ â”€â”€â”€â”€â”€â†’ â”‚ Domain Note  â”‚ â”€â”€â”€â”€â”€â†’ â”‚ PostgreSQL   â”‚
â”‚ (OpenAPIå‹)  â”‚ Controllerâ”‚ (ç´”ç²‹ãªGo)  â”‚ Gatewayâ”‚ (pgtype.UUID)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ãªãœï¼Ÿ**
- ãƒ‰ãƒ¡ã‚¤ãƒ³ã¯**ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«**ã«é›†ä¸­ã—ãŸã„
- ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚„DBãŒå¤‰ã‚ã£ã¦ã‚‚**ãƒ‰ãƒ¡ã‚¤ãƒ³ã¯å¤‰ãˆãŸããªã„**

### ğŸ“Œ ãƒ«ãƒ¼ãƒ«3: UseCase ã¯1ãƒ¡ã‚½ãƒƒãƒ‰1ä»•äº‹

```
âŒ æ‚ªã„ä¾‹ï¼š
func (u *UseCase) DoEverything() {
  // ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆ
  // é€šçŸ¥é€ä¿¡
  // ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
  // ...ä½•ã§ã‚‚ã‚„ã‚‹
}

âœ… è‰¯ã„ä¾‹ï¼š
func (u *UseCase) CreateNote() { /* ãƒãƒ¼ãƒˆä½œæˆã ã‘ */ }
func (u *UseCase) PublishNote() { /* å…¬é–‹ã ã‘ */ }
func (u *UseCase) DeleteNote() { /* å‰Šé™¤ã ã‘ */ }
```

**ãªãœï¼Ÿ**
- ãƒ†ã‚¹ãƒˆã—ã‚„ã™ã„
- å¤‰æ›´ã®å½±éŸ¿ç¯„å›²ãŒå°ã•ã„
- ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å¢ƒç•ŒãŒæ˜ç¢º

---

## å®¶ã¥ãã‚Šã§ç†è§£ã™ã‚‹ãƒ¬ã‚¤ãƒ¤ãƒ¼æ§‹é€ 

ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’**å®¶ã¥ãã‚Š**ã§ä¾‹ãˆã¾ã™ã€‚

```
                    ğŸ  ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®å®¶

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     ğŸšª ç„é–¢ (Cmd)                        â”‚ â† ã‚¢ãƒ—ãƒªã®å…¥å£
â”‚                  ãƒ»è¨ªå•è€…ã‚’è¿ãˆã‚‹                         â”‚
â”‚                  ãƒ»å®¶ã®æº–å‚™ã‚’ã™ã‚‹                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               ğŸ”§ é›»æ°—ãƒ»æ°´é“ (Driver)                      â”‚ â† ã‚¤ãƒ³ãƒ•ãƒ©ã®é…ç·š
â”‚          ãƒ»DBæ¥ç¶šã€è¨­å®šã€Factoryãªã©                      â”‚
â”‚          ãƒ»å„éƒ¨å±‹ã«å¿…è¦ãªã‚‚ã®ã‚’ä¾›çµ¦                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 ğŸ“ å—ä»˜çª“å£ (Controller)                  â”‚ â† å¤–éƒ¨ã¨ã®ã‚„ã‚Šå–ã‚Š
â”‚          ãƒ»ãŠå®¢ã•ã‚“ã®è¦æœ›ã‚’èã                           â”‚
â”‚          ãƒ»æ—¥æœ¬èªã‚’å®¶ã®äººã«é€šè¨³                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                ğŸ¯ æŒ‡ä»¤å®¤ (UseCase)                       â”‚ â† ä»•äº‹ã®æ‰‹é †
â”‚          ãƒ»ä½•ã‚’ã©ã†å‡¦ç†ã™ã‚‹ã‹æ±ºã‚ã‚‹                        â”‚
â”‚          ãƒ»å„éƒ¨å±‹ã«æŒ‡ç¤ºã‚’å‡ºã™                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              â¤ï¸ å¿ƒè‡“éƒ¨ (Domain)                          â”‚ â† ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«
â”‚          ãƒ»å®¶ã®æ ¹æœ¬çš„ãªãƒ«ãƒ¼ãƒ«                             â”‚
â”‚          ãƒ»ã€Œä½•ãŒæ­£ã—ã„ã‹ã€ã‚’çŸ¥ã£ã¦ã‚‹                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ğŸ“¦ å€‰åº«ãƒ»éƒµä¾¿å±€ (Gateway/Presenter)                â”‚ â† å¤–éƒ¨ã¨ã®å¤‰æ›
â”‚     ãƒ»å®¶ã®ã‚‚ã®ã‚’å¤–ã®å½¢å¼ã«å¤‰æ›                            â”‚
â”‚     ãƒ»å¤–ã®ã‚‚ã®ã‚’å®¶ã®å½¢å¼ã«å¤‰æ›                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å„éƒ¨å±‹ã®å½¹å‰²

| éƒ¨å±‹ | å®Ÿéš›ã®ãƒ¬ã‚¤ãƒ¤ãƒ¼ | ã‚„ã‚‹ã“ã¨ |
|------|--------------|----------|
| ğŸšª ç„é–¢ | **Cmd** | mainé–¢æ•°ã€‚ã‚µãƒ¼ãƒãƒ¼èµ·å‹•ã ã‘ |
| ğŸ”§ é›»æ°—ãƒ»æ°´é“ | **Driver** | DBæ¥ç¶šã€è¨­å®šã€Factoryï¼ˆé…ç·šï¼‰ |
| ğŸ“ å—ä»˜çª“å£ | **Controller** | HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ã‘å–ã‚‹ |
| ğŸ¯ æŒ‡ä»¤å®¤ | **UseCase** | ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã®æ‰‹é † |
| â¤ï¸ å¿ƒè‡“éƒ¨ | **Domain** | ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«ï¼ˆä¸å¤‰æ¡ä»¶ï¼‰ |
| ğŸ“¦ å€‰åº«ãƒ»éƒµä¾¿å±€ | **Gateway/Presenter** | DB/HTTPã¨ã®å¤‰æ› |
| ğŸ“ å¥‘ç´„æ›¸ | **Port** | å„ãƒ¬ã‚¤ãƒ¤ãƒ¼é–“ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ |

---

## ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å†’é™º - ãƒ‡ãƒ¼ã‚¿ã®æµã‚Œã‚’è¿½ã†

å®Ÿéš›ã« **GET /api/notes/123** ã¨ã„ã†ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒæ¥ãŸã‚‰ã€ä½•ãŒèµ·ã“ã‚‹ã®ã‹ã€å†’é™ºå½¢å¼ã§è¿½ã„ã‹ã‘ã¾ã—ã‚‡ã†ï¼

```
ğŸŒ ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆ
    â”‚
    â”‚ GET /api/notes/123
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1ï¸âƒ£ Echo (Webãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯)                   â”‚
â”‚     ã€ŒãŠã£ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒæ¥ãŸï¼ã€                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â”‚ ã€Œ/api/notes/:id ã®Controllerã‚’å‘¼ã¶ã‚ˆã€
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2ï¸âƒ£ Controller (å—ä»˜çª“å£)                      â”‚
â”‚     func (c *NoteController) GetByID(...)      â”‚
â”‚                                                â”‚
â”‚     ã‚„ã‚‹ã“ã¨ï¼š                                  â”‚
â”‚     - ãƒ‘ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ "123" ã‚’å–ã‚Šå‡ºã™           â”‚
â”‚     - UseCaseã«ã€ŒID=123ã®ãƒãƒ¼ãƒˆæ¬²ã—ã„ã€ã¨ä¼ãˆã‚‹ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â”‚ input.Get(ctx, "123")
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3ï¸âƒ£ UseCase (æŒ‡ä»¤å®¤)                           â”‚
â”‚     func (u *NoteInteractor) Get(...)          â”‚
â”‚                                                â”‚
â”‚     ã‚„ã‚‹ã“ã¨ï¼š                                  â”‚
â”‚     - Repository ã«ã€Œãƒãƒ¼ãƒˆå–ã£ã¦ãã¦ã€         â”‚
â”‚     - å–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’Presenterã«æ¸¡ã™           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚                              â†‘
    â”‚ Get(ctx, "123")              â”‚
    â†“                              â”‚ å–å¾—ã—ãŸNote
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  4ï¸âƒ£ Repository       â”‚           â”‚
â”‚  (Gateway - å€‰åº«)    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚                      â”‚
â”‚  ã‚„ã‚‹ã“ã¨ï¼š           â”‚
â”‚  - DBã«å•ã„åˆã‚ã›     â”‚
â”‚  - DBè¡Œã‚’Domainã«å¤‰æ› â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â”‚ SELECT * FROM notes WHERE id = '123'
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  5ï¸âƒ£ PostgreSQL                                 â”‚
â”‚     ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹                                â”‚
â”‚                                                â”‚
â”‚     è¿”å´: Row{id, title, ...}                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â”‚ pgx.Row â†’ note.WithMeta (ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«)
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  6ï¸âƒ£ Presenter (éƒµä¾¿å±€)                         â”‚
â”‚     func (p *NotePresenter) PresentNote(...)   â”‚
â”‚                                                â”‚
â”‚     ã‚„ã‚‹ã“ã¨ï¼š                                  â”‚
â”‚     - note.WithMeta â†’ OpenAPI Response         â”‚
â”‚     - CreatedAt ã‚’ ISO8601å½¢å¼ã«ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â”‚ OpenAPI Response JSON
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  7ï¸âƒ£ Controller ãŒ JSONè¿”å´                     â”‚
â”‚     return ctx.JSON(http.StatusOK, p.Note())   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â”‚ HTTP 200 OK
    â†“
ğŸŒ ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆ (ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ–ãƒ©ã‚¦ã‚¶)
```

### ãƒã‚¤ãƒ³ãƒˆæ•´ç†

```
ğŸ”„ ãƒ‡ãƒ¼ã‚¿å¤‰æ›ã®æµã‚Œ

HTTP JSON â”€â”€Controllerâ”€â”€â†’ string "123"
                â†“
         UseCase ãŒå‡¦ç†
                â†“
         Repository ãŒå‘¼ã°ã‚Œã‚‹
                â†“
pgx.Row â”€â”€Gatewayâ”€â”€â†’ note.WithMeta (Domain)
                â†“
         UseCase ãŒ Presenter ã«æ¸¡ã™
                â†“
note.WithMeta â”€â”€Presenterâ”€â”€â†’ OpenAPI Response
                â†“
         Controller ãŒè¿”ã™
                â†“
          HTTP JSON
```

**ãªãœã“ã‚“ãªã«å¤‰æ›ã™ã‚‹ã®ï¼Ÿ**

â†’ **å„ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒç‹¬ç«‹ã—ã¦ã„ã¦ã€ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚„DBã‚’ç°¡å˜ã«å¤‰æ›´ã§ãã‚‹ã‹ã‚‰ï¼**

---

## å„ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®è©³ç´°è§£èª¬

### 1ï¸âƒ£ Domain (ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤) - ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«ã®ä¸­å¿ƒ

**å ´æ‰€:** `internal/domain/`

**å½¹å‰²:** ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ã€Œå¿ƒè‡“éƒ¨ã€ã€‚ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«ã‚’è¡¨ç¾ã™ã‚‹ã€‚

#### ä½•ã‚’æ›¸ãï¼Ÿ

```go
// âœ… Entity (ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£) - ãƒ“ã‚¸ãƒã‚¹ã®ã€Œã‚‚ã®ã€
type Note struct {
    ID         string
    Title      string
    TemplateID string
    OwnerID    string
    Status     NoteStatus  // Draft or Publish
    Sections   []Section
    CreatedAt  time.Time
    UpdatedAt  time.Time
}

// âœ… Value Object (å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ) - çŠ¶æ…‹
type NoteStatus string

const (
    StatusDraft   NoteStatus = "Draft"
    StatusPublish NoteStatus = "Publish"
)

// âœ… ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ« - ã€Œã€œã—ã¦ã¯ã„ã‘ãªã„ã€
func CanChangeStatus(from, to NoteStatus) error {
    if from == StatusDraft && to == StatusPublish {
        return nil  // OK: ä¸‹æ›¸ã â†’ å…¬é–‹
    }
    if from == StatusPublish && to == StatusDraft {
        return nil  // OK: å…¬é–‹ â†’ ä¸‹æ›¸ã
    }
    if from == to {
        return nil  // OK: åŒã˜çŠ¶æ…‹
    }
    return domainerr.ErrInvalidStatusChange  // NG!
}

// âœ… æ¤œè¨¼ãƒ­ã‚¸ãƒƒã‚¯
func ValidateNoteOwnership(noteOwnerID, actorID string) error {
    if noteOwnerID != actorID {
        return domainerr.ErrUnauthorized
    }
    return nil
}
```

#### âŒ æ›¸ã„ã¡ã‚ƒãƒ€ãƒ¡ãªã‚‚ã®

```go
// âŒ NG: HTTPé–¢é€£
import "github.com/labstack/echo/v4"

// âŒ NG: DBé–¢é€£
import "github.com/jackc/pgx/v5"

// âŒ NG: å¤–éƒ¨ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯
import openapi "..."
```

**ãƒ‰ãƒ¡ã‚¤ãƒ³ã¯ç´”ç²‹ãªGoã§æ›¸ãï¼**

#### ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆä¾‹

```
internal/domain/note/
â”œâ”€â”€ entity.go           â† Note, Section ã®å®šç¾©
â”œâ”€â”€ types.go            â† NoteStatus ãªã©ã®å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
â”œâ”€â”€ logic.go            â† ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«ã®é–¢æ•°
â”œâ”€â”€ aggregate.go        â† Noteã¨é–¢é€£ãƒ‡ãƒ¼ã‚¿ã‚’ã¾ã¨ã‚ãŸå‹
â””â”€â”€ logic_test.go       â† ãƒ†ã‚¹ãƒˆ
```

---

### 2ï¸âƒ£ UseCase (ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å±¤) - ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®æ‰‹é †æ›¸

**å ´æ‰€:** `internal/usecase/`

**å½¹å‰²:** ã€Œä½•ã‚’ã©ã®é †ç•ªã§ã‚„ã‚‹ã‹ã€ã‚’æ±ºã‚ã‚‹æŒ‡ä»¤å®¤ã€‚

#### ä½•ã‚’æ›¸ãï¼Ÿ

```go
// âœ… UseCase (Interactor) ã®æ§‹é€ 
type NoteInteractor struct {
    notes     port.NoteRepository      // â† PortçµŒç”±ã§ä¾å­˜
    templates port.TemplateRepository
    tx        port.TxManager
    output    port.NoteOutputPort
}

// âœ… ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã®æ‰‹é †
func (u *NoteInteractor) Create(ctx context.Context, input port.NoteCreateInput) error {
    // 1. ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå–å¾—
    tpl, err := u.templates.Get(ctx, input.TemplateID)
    if err != nil {
        return err
    }

    // 2. ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ«ãƒ¼ãƒ«ã§æ¤œè¨¼
    sections := buildSections("", tpl.Template.Fields, input.Sections)
    if err := note.ValidateNoteForCreate(input.Title, tpl.Template, sections); err != nil {
        return err
    }

    // 3. ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³é–‹å§‹
    var noteID string
    err = u.tx.WithinTransaction(ctx, func(txCtx context.Context) error {
        // 4. ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚µãƒ¼ãƒ“ã‚¹ã§ãƒãƒ¼ãƒˆæ§‹ç¯‰
        built, err := service.BuildNote(input.Title, tpl.Template, input.OwnerID, sections)
        if err != nil {
            return err
        }

        // 5. Repository ã§ä¿å­˜
        nn, err := u.notes.Create(txCtx, built)
        if err != nil {
            return err
        }
        noteID = nn.ID

        // 6. ã‚»ã‚¯ã‚·ãƒ§ãƒ³ä¿å­˜
        sectionsWithID := buildSections(noteID, tpl.Template.Fields, input.Sections)
        return u.notes.ReplaceSections(txCtx, noteID, sectionsWithID)
    })

    if err != nil {
        return err
    }

    // 7. æœ€æ–°ãƒ‡ãƒ¼ã‚¿å–å¾—ã—ã¦Presenterã«æ¸¡ã™
    n, err := u.notes.Get(ctx, noteID)
    if err != nil {
        return err
    }
    return u.output.PresentNote(ctx, n)
}
```

#### ãƒã‚¤ãƒ³ãƒˆ

- **æ‰‹é †æ›¸ã¿ãŸã„ã«èª­ã‚ã‚‹** â† ã‚³ãƒ¡ãƒ³ãƒˆã§ç•ªå·æŒ¯ã£ã¦OK
- **Portï¼ˆã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ï¼‰çµŒç”±ã§å¤–éƒ¨ã‚’å‘¼ã¶** â† ä¾å­˜ã‚’é€†è»¢
- **ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å¢ƒç•Œã‚’æ±ºã‚ã‚‹** â† ã“ã“ã§é–‹å§‹ãƒ»çµ‚äº†

#### âŒ æ›¸ã„ã¡ã‚ƒãƒ€ãƒ¡ãªã‚‚ã®

```go
// âŒ NG: HTTPãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’ç›´æ¥è¿”ã™
return ctx.JSON(200, note)

// âŒ NG: å…·ä½“çš„ãªDBå®Ÿè£…ã«ä¾å­˜
notes := &db.NoteRepository{}

// âœ… OK: Portã«ä¾å­˜
notes port.NoteRepository
```

---

### 3ï¸âƒ£ Port (ãƒãƒ¼ãƒˆå±¤) - å¥‘ç´„æ›¸

**å ´æ‰€:** `internal/port/`

**å½¹å‰²:** ãƒ¬ã‚¤ãƒ¤ãƒ¼é–“ã®ã€Œç´„æŸäº‹ã€ã‚’å®šç¾©ã™ã‚‹ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã€‚

#### ä½•ã‚’æ›¸ãï¼Ÿ

```go
// âœ… InputPort - UseCaseã¸ã®å…¥å£
type NoteInputPort interface {
    List(ctx context.Context, filters note.Filters) error
    Get(ctx context.Context, id string) error
    Create(ctx context.Context, input NoteCreateInput) error
    Update(ctx context.Context, input NoteUpdateInput) error
    Delete(ctx context.Context, id, ownerID string) error
}

// âœ… OutputPort - UseCaseã‹ã‚‰ã®å‡ºå£ï¼ˆPresenterã¸ï¼‰
type NoteOutputPort interface {
    PresentNoteList(ctx context.Context, notes []note.WithMeta) error
    PresentNote(ctx context.Context, note *note.WithMeta) error
    PresentNoteDeleted(ctx context.Context) error
}

// âœ… Repository - ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–ã®å¥‘ç´„
type NoteRepository interface {
    List(ctx context.Context, filters note.Filters) ([]note.WithMeta, error)
    Get(ctx context.Context, id string) (*note.WithMeta, error)
    Create(ctx context.Context, n note.Note) (*note.Note, error)
    Update(ctx context.Context, n note.Note) (*note.Note, error)
    Delete(ctx context.Context, id string) error
}

// âœ… å…¥åŠ›DTO
type NoteCreateInput struct {
    Title      string
    TemplateID string
    OwnerID    string
    Sections   []SectionInput
}
```

#### ãªãœå¿…è¦ï¼Ÿ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  UseCase     â”‚                    â”‚  UseCase     â”‚
â”‚              â”‚                    â”‚              â”‚
â”‚  å…·ä½“çš„ãªå®Ÿè£…â”‚ â† ã“ã‚Œã ã¨ãƒ†ã‚¹ãƒˆ   â”‚  Interface   â”‚ â† ãƒ†ã‚¹ãƒˆç°¡å˜ï¼
â”‚  ã«ä¾å­˜      â”‚    ã—ã«ãã„        â”‚  ã«ä¾å­˜      â”‚    Mockã§ãã‚‹
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“                                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚PostgresRepo  â”‚                    â”‚   Port       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                            â†‘
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚                â”‚
                              PostgresRepo      MockRepo
                              (æœ¬ç•ª)            (ãƒ†ã‚¹ãƒˆ)
```

---

### 4ï¸âƒ£ Controller (ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼å±¤) - HTTPå…¥åŠ›ã®å—ä»˜

**å ´æ‰€:** `internal/adapter/http/controller/`

**å½¹å‰²:** HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ã‘å–ã‚Šã€UseCaseã«æ¸¡ã™ã€Œé€šè¨³ã€ã€‚

#### ä½•ã‚’æ›¸ãï¼Ÿ

```go
// âœ… Controlleræ§‹é€ 
type NoteController struct {
    inputFactory    func(...) port.NoteInputPort
    outputFactory   func() *presenter.NotePresenter
    noteRepoFactory func() port.NoteRepository
    tplRepoFactory  func() port.TemplateRepository
    txFactory       func() port.TxManager
}

// âœ… HTTPãƒãƒ³ãƒ‰ãƒ©
func (c *NoteController) Create(ctx echo.Context) error {
    // 1. ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£ã‚’ãƒ‘ãƒ¼ã‚¹
    var body openapi.ModelsCreateNoteRequest
    if err := ctx.Bind(&body); err != nil {
        return ctx.JSON(http.StatusBadRequest,
            openapi.ModelsBadRequestError{
                Code:    openapi.ModelsBadRequestErrorCodeBADREQUEST,
                Message: "invalid body",
            })
    }

    // 2. OpenAPIå‹ â†’ ãƒ‰ãƒ¡ã‚¤ãƒ³å…¥åŠ›DTOã«å¤‰æ›
    ownerID := body.OwnerId.String()
    sections := []port.SectionInput{}
    if body.Sections != nil {
        for _, s := range *body.Sections {
            sections = append(sections, port.SectionInput{
                FieldID: s.FieldId,
                Content: s.Content,
            })
        }
    }

    // 3. UseCaseã‚’å‘¼ã¶
    input, p := c.newIO()
    err := input.Create(ctx.Request().Context(), port.NoteCreateInput{
        Title:      body.Title,
        TemplateID: body.TemplateId.String(),
        OwnerID:    ownerID,
        Sections:   sections,
    })
    if err != nil {
        return handleError(ctx, err)
    }

    // 4. Presenterã‹ã‚‰çµæœã‚’å–å¾—ã—ã¦è¿”ã™
    return ctx.JSON(http.StatusOK, p.Note())
}
```

#### ãƒã‚¤ãƒ³ãƒˆ

- **OpenAPIå‹ â†’ ãƒ‰ãƒ¡ã‚¤ãƒ³DTOã¸ã®å¤‰æ›** â† Controllerã®ä»•äº‹
- **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°** â† ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¨ãƒ©ãƒ¼ã‚’HTTPã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã«å¤‰æ›
- **FactoryçµŒç”±ã§UseCaseã‚’å–å¾—** â† DIï¼ˆä¾å­˜æ€§æ³¨å…¥ï¼‰

---

### 5ï¸âƒ£ Presenter (ãƒ—ãƒ¬ã‚¼ãƒ³ã‚¿ãƒ¼å±¤) - HTTPå‡ºåŠ›ã®æ•´å½¢

**å ´æ‰€:** `internal/adapter/http/presenter/`

**å½¹å‰²:** ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã‚’HTTPãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«å¤‰æ›ã™ã‚‹ã€Œç¿»è¨³è€…ã€ã€‚

#### ä½•ã‚’æ›¸ãï¼Ÿ

```go
// âœ… Presenteræ§‹é€ 
type NotePresenter struct {
    note      *openapi.ModelsNoteResponse
    notes     []openapi.ModelsNoteResponse
    deletedOK bool
}

// âœ… OutputPortã®å®Ÿè£…
func (p *NotePresenter) PresentNote(_ context.Context, n *note.WithMeta) error {
    resp := toNoteResponse(*n)
    p.note = &resp  // çµæœã‚’ä¿å­˜
    return nil
}

// âœ… ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ« â†’ OpenAPIå‹ã¸ã®å¤‰æ›
func toNoteResponse(n note.WithMeta) openapi.ModelsNoteResponse {
    sections := make([]openapi.ModelsSection, 0, len(n.Sections))
    for _, s := range n.Sections {
        sections = append(sections, openapi.ModelsSection{
            Id:         s.Section.ID,
            FieldId:    s.Section.FieldID,
            FieldLabel: s.FieldLabel,
            Content:    s.Section.Content,
            IsRequired: s.IsRequired,
        })
    }

    return openapi.ModelsNoteResponse{
        Id:           n.Note.ID,
        Title:        n.Note.Title,
        TemplateId:   n.Note.TemplateID,
        TemplateName: n.TemplateName,
        OwnerId:      n.Note.OwnerID,
        Owner: openapi.ModelsAccountSummary{
            Id:        n.Note.OwnerID,
            FirstName: n.OwnerFirstName,
            LastName:  n.OwnerLastName,
            Thumbnail: n.OwnerThumbnail,
        },
        Status:    openapi.ModelsNoteStatus(n.Note.Status),
        Sections:  sections,
        CreatedAt: n.Note.CreatedAt,
        UpdatedAt: n.Note.UpdatedAt,
    }
}
```

#### ãƒã‚¤ãƒ³ãƒˆ

- **çµæœã‚’å†…éƒ¨ã§ä¿å­˜** â† ControllerãŒå¾Œã§å–ã‚Šå‡ºã™
- **ãƒ‰ãƒ¡ã‚¤ãƒ³ â†’ OpenAPIã¸ã®å¤‰æ›** â† Presenterã®ä»•äº‹

---

### 6ï¸âƒ£ Gateway (ã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤å±¤) - DBã¨ã®ã‚„ã‚Šå–ã‚Š

**å ´æ‰€:** `internal/adapter/gateway/db/`

**å½¹å‰²:** ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã€ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã«å¤‰æ›ã™ã‚‹ã€Œå€‰åº«ç•ªã€ã€‚

#### ä½•ã‚’æ›¸ãï¼Ÿ

```go
// âœ… Repositoryå®Ÿè£…
type NoteRepository struct {
    pool    *pgxpool.Pool
    queries *sqldb.Queries  // sqlcç”Ÿæˆã‚³ãƒ¼ãƒ‰
}

// âœ… Portã®å®Ÿè£…
func (r *NoteRepository) Get(ctx context.Context, id string) (*note.WithMeta, error) {
    // 1. UUIDã«å¤‰æ›
    pgID, err := toUUID(id)
    if err != nil {
        return nil, err
    }

    // 2. sqlcã§DBå•ã„åˆã‚ã›
    row, err := queriesForContext(ctx, r.queries).GetNoteByID(ctx, pgID)
    if err != nil {
        // âŒ pgx.ErrNoRows ã‚’ãã®ã¾ã¾è¿”ã•ãªã„ï¼
        if errors.Is(err, pgx.ErrNoRows) {
            return nil, domainerr.ErrNotFound  // âœ… ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¨ãƒ©ãƒ¼ã«å¤‰æ›
        }
        return nil, err
    }

    // 3. Sectionã‚’å–å¾—
    sections, err := r.listSections(ctx, row.ID)
    if err != nil {
        return nil, err
    }

    // 4. DBè¡Œ â†’ ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã«å¤‰æ›
    return &note.WithMeta{
        Note: note.Note{
            ID:         uuidToString(row.ID),      // pgtype.UUID â†’ string
            Title:      row.Title,
            TemplateID: uuidToString(row.TemplateID),
            OwnerID:    uuidToString(row.OwnerID),
            Status:     note.NoteStatus(row.Status),
            CreatedAt:  timestamptzToTime(row.CreatedAt),
            UpdatedAt:  timestamptzToTime(row.UpdatedAt),
        },
        TemplateName:   row.TemplateName,
        OwnerFirstName: row.FirstName,
        OwnerLastName:  row.LastName,
        OwnerThumbnail: thumbnail,
        Sections:       sections,
    }, nil
}
```

#### ãƒã‚¤ãƒ³ãƒˆ

- **DBå‹ â†’ ãƒ‰ãƒ¡ã‚¤ãƒ³å‹ã¸ã®å¤‰æ›** â† `pgtype.UUID` â†’ `string`
- **DBã‚¨ãƒ©ãƒ¼ â†’ ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¨ãƒ©ãƒ¼ã¸ã®å¤‰æ›** â† `pgx.ErrNoRows` â†’ `domainerr.ErrNotFound`
- **sqlcç”Ÿæˆã‚³ãƒ¼ãƒ‰ã‚’ä½¿ã†** â† ã‚¿ã‚¤ãƒ—ã‚»ãƒ¼ãƒ•ãªSQL

---

### 7ï¸âƒ£ Driver (ãƒ‰ãƒ©ã‚¤ãƒãƒ¼å±¤) - é…ç·šå·¥å ´

**å ´æ‰€:** `internal/driver/`

**å½¹å‰²:** DBæ¥ç¶šã€è¨­å®šã€Factoryé–¢æ•°ãªã©ã€Œã‚¤ãƒ³ãƒ•ãƒ©ã®æº–å‚™ã€ã€‚

#### ä½•ã‚’æ›¸ãï¼Ÿ

```go
// âœ… Factoryé–¢æ•°
// internal/driver/factory/usecase_factory.go
func NewNoteInputFactory() func(
    noteRepo port.NoteRepository,
    tplRepo port.TemplateRepository,
    tx port.TxManager,
    output port.NoteOutputPort,
) port.NoteInputPort {
    return func(noteRepo port.NoteRepository, tplRepo port.TemplateRepository, tx port.TxManager, output port.NoteOutputPort) port.NoteInputPort {
        return usecase.NewNoteInteractor(noteRepo, tplRepo, tx, output)
    }
}

// âœ… DBæ¥ç¶š
// internal/driver/db/pool.go
func NewPool(ctx context.Context, cfg *config.DBConfig) (*pgxpool.Pool, error) {
    poolCfg, err := pgxpool.ParseConfig(cfg.DatabaseURL)
    if err != nil {
        return nil, err
    }
    return pgxpool.NewWithConfig(ctx, poolCfg)
}

// âœ… Initializer - å…¨ä½“ã®çµ„ã¿ç«‹ã¦
// internal/driver/initializer/api/initializer.go
func BuildServer(ctx context.Context) (*echo.Echo, func(), error) {
    // 1. è¨­å®šèª­ã¿è¾¼ã¿
    cfg := config.Load()

    // 2. DBæ¥ç¶š
    pool, err := db.NewPool(ctx, cfg.DB)
    if err != nil {
        return nil, nil, err
    }

    // 3. Factoryã‚’ä½œæˆ
    noteInputFactory := factory.NewNoteInputFactory()
    noteOutputFactory := factory.NewNotePresenterFactory()
    // ...

    // 4. Controllerã‚’ä½œæˆ
    noteCtrl := controller.NewNoteController(
        noteInputFactory,
        noteOutputFactory,
        noteRepoFactory,
        tplRepoFactory,
        txFactory,
    )

    // 5. ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°è¨­å®š
    server := controller.NewServer(noteCtrl, tplCtrl, accountCtrl)

    cleanup := func() {
        pool.Close()
    }

    return server.Echo, cleanup, nil
}
```

---

### 8ï¸âƒ£ Cmd (ã‚³ãƒãƒ³ãƒ‰å±¤) - ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ

**å ´æ‰€:** `cmd/api/main.go`

**å½¹å‰²:** ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®èµ·å‹•ã€‚ã“ã‚Œã ã‘ï¼

#### ä½•ã‚’æ›¸ãï¼Ÿ

```go
func main() {
    ctx := context.Background()

    // 1. ã‚µãƒ¼ãƒãƒ¼æ§‹ç¯‰
    e, cleanup, err := initializer.BuildServer(ctx)
    if err != nil {
        log.Fatalf("failed to initialize server: %v", err)
    }
    defer cleanup()

    // 2. ã‚µãƒ¼ãƒãƒ¼èµ·å‹•
    addr := ":8080"
    log.Printf("starting HTTP server at %s\n", addr)
    if err := e.Start(addr); err != nil {
        log.Fatalf("server exited: %v", err)
    }
}
```

**mainé–¢æ•°ã¯çŸ­ãï¼** â† è©³ç´°ã¯Initializerã«ä»»ã›ã‚‹

---

## å®Ÿä¾‹ã§å­¦ã¶: ãƒãƒ¼ãƒˆä½œæˆæ©Ÿèƒ½

å®Ÿéš›ã®ã€Œãƒãƒ¼ãƒˆä½œæˆã€æ©Ÿèƒ½ã‚’ä¾‹ã«ã€å„ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒã©ã†é€£æºã™ã‚‹ã‹è¦‹ã¦ã„ãã¾ã—ã‚‡ã†ã€‚

### ã‚·ãƒŠãƒªã‚ª

ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã€Œæ—¥å ±ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã€ã‚’ä½¿ã£ã¦ã€æ–°ã—ã„ãƒãƒ¼ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚

```
POST /api/notes
{
  "title": "2025å¹´1æœˆ23æ—¥ã®æ—¥å ±",
  "template_id": "abc-123",
  "owner_id": "user-456",
  "sections": [
    {"field_id": "field-1", "content": "ä»Šæ—¥ã¯è¨­è¨ˆæ›¸ã‚’æ›¸ãã¾ã—ãŸ"},
    {"field_id": "field-2", "content": "æ˜æ—¥ã¯ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ã—ã¾ã™"}
  ]
}
```

### 1. Controller - ãƒªã‚¯ã‚¨ã‚¹ãƒˆå—ä»˜

[note_controller.go:73-101](internal/adapter/http/controller/note_controller.go#L73-L101)

```go
func (c *NoteController) Create(ctx echo.Context) error {
    // OpenAPIå‹ã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ã‘å–ã‚‹
    var body openapi.ModelsCreateNoteRequest
    if err := ctx.Bind(&body); err != nil {
        return ctx.JSON(http.StatusBadRequest, ...)
    }

    // ãƒ‰ãƒ¡ã‚¤ãƒ³DTOã«å¤‰æ›
    sections := []port.SectionInput{}
    if body.Sections != nil {
        for _, s := range *body.Sections {
            sections = append(sections, port.SectionInput{
                FieldID: s.FieldId,
                Content: s.Content,
            })
        }
    }

    // UseCaseã‚’å‘¼ã¶
    input, p := c.newIO()
    err := input.Create(ctx.Request().Context(), port.NoteCreateInput{
        Title:      body.Title,
        TemplateID: body.TemplateId.String(),
        OwnerID:    body.OwnerId.String(),
        Sections:   sections,
    })
    if err != nil {
        return handleError(ctx, err)
    }

    // Presenterã‹ã‚‰çµæœã‚’å–å¾—
    return ctx.JSON(http.StatusOK, p.Note())
}
```

### 2. UseCase - ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã®å®Ÿè¡Œ

[note_interactor.go:54-90](internal/usecase/note_interactor.go#L54-L90)

```go
func (u *NoteInteractor) Create(ctx context.Context, input port.NoteCreateInput) error {
    // 1. ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå–å¾—
    tpl, err := u.templates.Get(ctx, input.TemplateID)
    if err != nil {
        return err  // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãŒå­˜åœ¨ã—ãªã„
    }

    // 2. ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ«ãƒ¼ãƒ«ã§æ¤œè¨¼
    sections := buildSections("", tpl.Template.Fields, input.Sections)
    if err := note.ValidateNoteForCreate(input.Title, tpl.Template, sections); err != nil {
        return err  // ã‚¿ã‚¤ãƒˆãƒ«ãŒç©ºã€å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰æœªå…¥åŠ›ãªã©
    }

    // 3. ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³é–‹å§‹
    var noteID string
    err = u.tx.WithinTransaction(ctx, func(txCtx context.Context) error {
        // 4. ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚µãƒ¼ãƒ“ã‚¹ã§ãƒãƒ¼ãƒˆæ§‹ç¯‰
        built, err := service.BuildNote(input.Title, tpl.Template, input.OwnerID, sections)
        if err != nil {
            return err
        }

        // 5. ãƒãƒ¼ãƒˆä¿å­˜
        nn, err := u.notes.Create(txCtx, built)
        if err != nil {
            return err
        }
        noteID = nn.ID

        // 6. ã‚»ã‚¯ã‚·ãƒ§ãƒ³ä¿å­˜
        sectionsWithID := buildSections(noteID, tpl.Template.Fields, input.Sections)
        if err := note.ValidateSections(tpl.Template.Fields, sectionsWithID); err != nil {
            return err
        }
        return u.notes.ReplaceSections(txCtx, noteID, sectionsWithID)
    })

    if err != nil {
        return err  // ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯
    }

    // 7. ä½œæˆã•ã‚ŒãŸãƒãƒ¼ãƒˆã‚’å–å¾—ã—ã¦Presenterã«æ¸¡ã™
    n, err := u.notes.Get(ctx, noteID)
    if err != nil {
        return err
    }
    return u.output.PresentNote(ctx, n)
}
```

### 3. Domain - ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«

[note/logic.go:62-80](internal/domain/note/logic.go#L62-L80)

```go
// ãƒãƒ¼ãƒˆä½œæˆæ™‚ã®æ¤œè¨¼
func ValidateNoteForCreate(title string, tpl template.Template, sections []Section) error {
    if strings.TrimSpace(title) == "" {
        return domainerr.ErrTitleRequired  // ã‚¿ã‚¤ãƒˆãƒ«å¿…é ˆ
    }
    if tpl.ID == "" {
        return domainerr.ErrTemplateOwnerRequired
    }
    if tpl.OwnerID == "" {
        return domainerr.ErrOwnerRequired
    }
    if err := template.ValidateTemplate(tpl); err != nil {
        return err
    }
    if err := ValidateSections(tpl.Fields, sections); err != nil {
        return err  // å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãƒã‚§ãƒƒã‚¯
    }
    return nil
}
```

### 4. Domain Service - ãƒãƒ¼ãƒˆæ§‹ç¯‰

[service/note_lifecycle.go:9-24](internal/domain/service/note_lifecycle.go#L9-L24)

```go
// ãƒãƒ¼ãƒˆã‚’æ§‹ç¯‰
func BuildNote(title string, tpl template.Template, ownerID string, sections []Section) (note.Note, error) {
    if err := note.ValidateNoteForCreate(title, tpl, sections); err != nil {
        return note.Note{}, err
    }
    if ownerID == "" {
        return note.Note{}, domainerr.ErrOwnerRequired
    }
    return note.Note{
        Title:      title,
        TemplateID: tpl.ID,
        OwnerID:    ownerID,
        Status:     note.StatusDraft,  // å¿…ãšä¸‹æ›¸ãã§ä½œæˆ
        Sections:   sections,
    }, nil
}
```

### 5. Repository - DBä¿å­˜

[gateway/db/note_repository.go:130-158](internal/adapter/gateway/db/note_repository.go#L130-L158)

```go
func (r *NoteRepository) Create(ctx context.Context, n note.Note) (*note.Note, error) {
    // 1. string â†’ pgtype.UUIDã«å¤‰æ›
    templateID, err := toUUID(n.TemplateID)
    if err != nil {
        return nil, err
    }
    ownerID, err := toUUID(n.OwnerID)
    if err != nil {
        return nil, err
    }

    // 2. sqlcã§INSERT
    row, err := queriesForContext(ctx, r.queries).CreateNote(ctx, &sqldb.CreateNoteParams{
        Title:      n.Title,
        TemplateID: templateID,
        OwnerID:    ownerID,
        Status:     string(n.Status),
    })
    if err != nil {
        return nil, err
    }

    // 3. DBè¡Œ â†’ ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã«å¤‰æ›
    return &note.Note{
        ID:         uuidToString(row.ID),
        Title:      row.Title,
        TemplateID: uuidToString(row.TemplateID),
        OwnerID:    uuidToString(row.OwnerID),
        Status:     note.NoteStatus(row.Status),
        CreatedAt:  timestamptzToTime(row.CreatedAt),
        UpdatedAt:  timestamptzToTime(row.UpdatedAt),
    }, nil
}
```

### 6. Presenter - ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ•´å½¢

[presenter/note_presenter.go:36-41](internal/adapter/http/presenter/note_presenter.go#L36-L41)

```go
func (p *NotePresenter) PresentNote(_ context.Context, n *note.WithMeta) error {
    resp := toNoteResponse(*n)
    p.note = &resp  // çµæœã‚’ä¿å­˜
    return nil
}

func toNoteResponse(n note.WithMeta) openapi.ModelsNoteResponse {
    sections := make([]openapi.ModelsSection, 0, len(n.Sections))
    for _, s := range n.Sections {
        sections = append(sections, openapi.ModelsSection{
            Id:         s.Section.ID,
            FieldId:    s.Section.FieldID,
            FieldLabel: s.FieldLabel,
            Content:    s.Section.Content,
            IsRequired: s.IsRequired,
        })
    }

    return openapi.ModelsNoteResponse{
        Id:           n.Note.ID,
        Title:        n.Note.Title,
        TemplateId:   n.Note.TemplateID,
        TemplateName: n.TemplateName,
        OwnerId:      n.Note.OwnerID,
        Owner: openapi.ModelsAccountSummary{
            Id:        n.Note.OwnerID,
            FirstName: n.OwnerFirstName,
            LastName:  n.OwnerLastName,
            Thumbnail: n.OwnerThumbnail,
        },
        Status:    openapi.ModelsNoteStatus(n.Note.Status),
        Sections:  sections,
        CreatedAt: n.Note.CreatedAt,
        UpdatedAt: n.Note.UpdatedAt,
    }
}
```

### ã¾ã¨ã‚: ãƒ‡ãƒ¼ã‚¿ã®å¤‰æ›ãƒ•ãƒ­ãƒ¼

```
HTTP Request (JSON)
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Controller                          â”‚
â”‚ openapi.ModelsCreateNoteRequest     â”‚
â”‚         â†“ å¤‰æ›                      â”‚
â”‚ port.NoteCreateInput                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ UseCase                             â”‚
â”‚ ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚µãƒ¼ãƒ“ã‚¹å‘¼ã³å‡ºã—              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Domain Service                      â”‚
â”‚ note.Note (ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Repository                          â”‚
â”‚ note.Note                           â”‚
â”‚         â†“ å¤‰æ›                      â”‚
â”‚ sqldb.CreateNoteParams (sqlc)       â”‚
â”‚         â†“ DBä¿å­˜                    â”‚
â”‚ sqldb.Note (DBè¡Œ)                   â”‚
â”‚         â†“ å¤‰æ›                      â”‚
â”‚ note.Note                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ UseCase                             â”‚
â”‚ note.WithMeta å–å¾—                  â”‚
â”‚         â†“                           â”‚
â”‚ Presenterã«æ¸¡ã™                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Presenter                           â”‚
â”‚ note.WithMeta                       â”‚
â”‚         â†“ å¤‰æ›                      â”‚
â”‚ openapi.ModelsNoteResponse          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
HTTP Response (JSON)
```

---

## ã‚ˆãã‚ã‚‹è³ªå•ã¨ç­”ãˆ

### Q1: ãªã‚“ã§ã“ã‚“ãªã«è¤‡é›‘ã«ã™ã‚‹ã®ï¼Ÿã‚·ãƒ³ãƒ—ãƒ«ã˜ã‚ƒãƒ€ãƒ¡ãªã®ï¼Ÿ

**A:** å°ã•ã„ã‚¢ãƒ—ãƒªãªã‚‰ç¢ºã‹ã«ã‚ªãƒ¼ãƒãƒ¼ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°ã§ã™ã€‚ã§ã‚‚ï¼š

```
å°è¦æ¨¡ (1äººã€1ãƒ¶æœˆ):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   main.go    â”‚
â”‚  å…¨éƒ¨ã“ã“ï¼  â”‚ â† ã“ã‚Œã§OK
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ä¸­ã€œå¤§è¦æ¨¡ (ãƒãƒ¼ãƒ ã€é•·æœŸä¿å®ˆ):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£            â”‚
â”‚  ãƒ»ãƒ†ã‚¹ãƒˆã—ã‚„ã™ã„                  â”‚
â”‚  ãƒ»å¤‰æ›´ã«å¼·ã„                      â”‚
â”‚  ãƒ»ãƒãƒ¼ãƒ é–‹ç™ºã—ã‚„ã™ã„               â”‚
â”‚  ãƒ»ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯å¤‰æ›´ã§ãã‚‹         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯æ•™æãªã®ã§ã€ã‚ã–ã¨ä¸å¯§ã«åˆ†ã‘ã¦ã„ã¾ã™ã€‚**

---

### Q2: ã©ã®ãƒ¬ã‚¤ãƒ¤ãƒ¼ã«ãƒ†ã‚¹ãƒˆã‚’æ›¸ã‘ã°ã„ã„ï¼Ÿ

**A:** å…¨éƒ¨ï¼ã§ã‚‚å„ªå…ˆé †ä½ã¯ï¼š

```
æœ€å„ªå…ˆ: â­â­â­
â”œâ”€ Domain (ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«)
â”‚  â†’ ã“ã“ãŒå£Šã‚ŒãŸã‚‰è‡´å‘½çš„ï¼
â”‚
â”œâ”€ UseCase (æ‰‹é †)
â”‚  â†’ ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã®ãƒ†ã‚¹ãƒˆ
â”‚
æ¬¡ç‚¹: â­â­
â”œâ”€ Presenter (å¤‰æ›)
â”‚  â†’ ãƒ¬ã‚¹ãƒãƒ³ã‚¹å½¢å¼ãŒæ­£ã—ã„ã‹
â”‚
â”œâ”€ Gateway (DBå¤‰æ›)
â”‚  â†’ ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«å¤‰æ›ãŒæ­£ã—ã„ã‹
â”‚
æœ€å¾Œ: â­
â””â”€ Controller (HTTPãƒãƒ³ãƒ‰ãƒ©)
   â†’ çµåˆãƒ†ã‚¹ãƒˆã‚„E2Eã§ç¢ºèª
```

---

### Q3: Repositoryã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã¯ã©ã“ã«ç½®ãï¼Ÿ

**A:** ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ **Portï¼ˆ`internal/port`ï¼‰** ã«ç½®ã„ã¦ã„ã¾ã™ã€‚

```
Option A: Portã«ç½®ã (ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   port/        â”‚
â”‚  - NoteRepository interface
â”‚  - TemplateRepository interface
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†‘
         â”‚ å®Ÿè£…
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ gateway/db/    â”‚
â”‚  - NoteRepository struct
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Option B: Domainã«ç½®ã
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  domain/note/  â”‚
â”‚  - Note entity
â”‚  - NoteRepository interface  â† ã“ã“
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ã©ã£ã¡ã§ã‚‚OKï¼ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§æ±ºã‚ã‚ˆã†ã€‚
```

---

### Q4: OpenAPIç”Ÿæˆç‰©ã¯ã©ã“ã«ç½®ãï¼Ÿ

**A:** `internal/adapter/http/generated/openapi/`

**ç†ç”±:**
- ControllerãŒä½¿ã†å…¥åŠ›å‹ã ã‹ã‚‰
- Adapterã¯ã€Œå¤–éƒ¨ã¨ã®å¤‰æ›ã€ã‚’æ‹…å½“ã™ã‚‹å±¤
- Driverã¯ã€Œé…ç·šã€ã ã‘ã§ã€å‹å®šç¾©ã¯æŒãŸãªã„

---

### Q5: Driverã¨Gatewayã®é•ã„ã¯ï¼Ÿ

```
Driver (internal/driver/)
â”œâ”€ å½¹å‰²: é…ç·šã€è¨­å®šã€åˆæœŸåŒ–
â”œâ”€ ä¾‹: DBæ¥ç¶šã€Factoryã€Initializer
â””â”€ ã€Œæº–å‚™ã™ã‚‹äººã€

Gateway (internal/adapter/gateway/)
â”œâ”€ å½¹å‰²: å®Ÿéš›ã®ãƒ‡ãƒ¼ã‚¿å–å¾—ãƒ»å¤‰æ›
â”œâ”€ ä¾‹: PostgreSQL Repositoryã€å¤–éƒ¨API Client
â””â”€ ã€Œå®Ÿéš›ã«å‹•ãäººã€
```

---

### Q6: Factoryãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ä½¿ã†ç†ç”±ã¯ï¼Ÿ - è¶…è©³ã—ãè§£èª¬

**A:** Factoryãƒ‘ã‚¿ãƒ¼ãƒ³ã¯ä¸€è¦‹ã€Œé¢å€’ã€ã«è¦‹ãˆã¾ã™ãŒã€å®Ÿã¯**ãƒ†ã‚¹ãƒˆã¨æŸ”è»Ÿæ€§**ã®ãŸã‚ã®è¶…é‡è¦ãƒ‘ã‚¿ãƒ¼ãƒ³ã§ã™ã€‚

#### ğŸ¤” å•é¡Œ: Factoryä½¿ã‚ãªã„ã¨ã©ã†ãªã‚‹ï¼Ÿ

```go
// âŒ æ‚ªã„ä¾‹: ç›´æ¥ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–
type NoteController struct {
    usecase *usecase.NoteInteractor  // å…·ä½“çš„ãªå‹ã«ä¾å­˜ï¼
    repo    *db.NoteRepository       // å…·ä½“çš„ãªå‹ã«ä¾å­˜ï¼
}

func NewNoteController(pool *pgxpool.Pool) *NoteController {
    repo := &db.NoteRepository{pool: pool}

    // UseCaseã‚‚ç›´æ¥ä½œã‚‹
    usecase := &usecase.NoteInteractor{
        notes: repo,
        // ...
    }

    return &NoteController{
        usecase: usecase,
        repo:    repo,
    }
}
```

**ä½•ãŒå•é¡Œï¼Ÿ**

1. **ãƒ†ã‚¹ãƒˆãŒæ›¸ã‘ãªã„ï¼**
```go
// ãƒ†ã‚¹ãƒˆã—ãŸã„ã‘ã©...
func TestNoteController_Create(t *testing.T) {
    // âŒ æœ¬ç‰©ã®DBãŒå¿…è¦ï¼
    pool, _ := pgxpool.Connect(...)  // DBèµ·å‹•ã—ã¦ãªã„ã¨å‹•ã‹ãªã„
    ctrl := NewNoteController(pool)

    // âŒ UseCaseã‚’Mockã«å·®ã—æ›¿ãˆã‚‰ã‚Œãªã„
    // âŒ Repositoryã‚‚æœ¬ç‰©ã®DBã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹
    // â†’ ãƒ†ã‚¹ãƒˆé…ã„ã€ç’°å¢ƒä¾å­˜ã€å£Šã‚Œã‚„ã™ã„
}
```

2. **å¤‰æ›´ã«å¼±ã„ï¼**
```go
// å°†æ¥ã€MySQLã«å¤‰ãˆãŸããªã£ãŸã‚‰...
// â†’ NoteController ã‚’å…¨éƒ¨æ›¸ãç›´ã—ï¼
```

3. **ä¾å­˜ãŒå›ºå®šã•ã‚Œã‚‹**
```go
// usecase.NoteInteractor ã®å®Ÿè£…ã‚’å¤‰ãˆãŸã‚‰
// â†’ NoteController ã‚‚å¤‰æ›´ãŒå¿…è¦
```

---

#### âœ… è§£æ±ºç­–: Factoryä½¿ã†ã¨ã©ã†ãªã‚‹ï¼Ÿ

```go
// âœ… è‰¯ã„ä¾‹: Factoryãƒ‘ã‚¿ãƒ¼ãƒ³
type NoteController struct {
    // é–¢æ•°ï¼ˆFactoryï¼‰ã‚’ä¿å­˜
    inputFactory    func(...) port.NoteInputPort
    outputFactory   func() *presenter.NotePresenter
    noteRepoFactory func() port.NoteRepository
    txFactory       func() port.TxManager
}

func NewNoteController(
    inputFactory func(...) port.NoteInputPort,
    outputFactory func() *presenter.NotePresenter,
    noteRepoFactory func() port.NoteRepository,
    txFactory func() port.TxManager,
) *NoteController {
    return &NoteController{
        inputFactory:    inputFactory,
        outputFactory:   outputFactory,
        noteRepoFactory: noteRepoFactory,
        txFactory:       txFactory,
    }
}
```

**ä½•ãŒè‰¯ã„ï¼Ÿ**

1. **ãƒ†ã‚¹ãƒˆãŒç°¡å˜ï¼**
```go
// âœ… Mockã‚’ç°¡å˜ã«æ³¨å…¥ã§ãã‚‹
func TestNoteController_Create(t *testing.T) {
    // Mock Factory
    mockInputFactory := func(...) port.NoteInputPort {
        return &mock.NoteInteractor{} // ãƒ†ã‚¹ãƒˆç”¨ã®å½ç‰©
    }

    mockOutputFactory := func() *presenter.NotePresenter {
        return presenter.NewNotePresenter()
    }

    mockRepoFactory := func() port.NoteRepository {
        return &mock.NoteRepository{} // ãƒ†ã‚¹ãƒˆç”¨ã®å½ç‰©
    }

    mockTxFactory := func() port.TxManager {
        return &mock.TxManager{} // ãƒ†ã‚¹ãƒˆç”¨ã®å½ç‰©
    }

    // Factoryã‚’å·®ã—æ›¿ãˆã‚‹ã ã‘ï¼
    ctrl := NewNoteController(
        mockInputFactory,
        mockOutputFactory,
        mockRepoFactory,
        mockTxFactory,
    )

    // âœ… DBãªã—ã§ãƒ†ã‚¹ãƒˆã§ãã‚‹
    // âœ… é«˜é€Ÿ
    // âœ… å®‰å®š
}
```

2. **æŸ”è»Ÿæ€§ãŒé«˜ã„ï¼**
```go
// æœ¬ç•ªç’°å¢ƒ
ctrl := NewNoteController(
    factory.NewNoteInputFactory(),      // PostgreSQLç‰ˆ
    factory.NewNotePresenterFactory(),
    factory.NewNoteRepositoryFactory(pool),
    factory.NewTxFactory(pool),
)

// ãƒ†ã‚¹ãƒˆç’°å¢ƒ
ctrl := NewNoteController(
    testFactory.NewMockNoteInputFactory(),  // Mockç‰ˆ
    testFactory.NewMockPresenterFactory(),
    testFactory.NewMockRepositoryFactory(),
    testFactory.NewMockTxFactory(),
)

// å°†æ¥MySQLç‰ˆãŒå¿…è¦ãªã‚‰
ctrl := NewNoteController(
    mysqlFactory.NewNoteInputFactory(),  // MySQLç‰ˆ
    // ...
)
```

---

#### ğŸ¬ å®Ÿéš›ã®å‹•ã: ãƒªã‚¯ã‚¨ã‚¹ãƒˆã”ã¨ã«æ–°ã—ã„ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹

Factoryã¯ã€Œè¨­è¨ˆå›³ã€ã‚’ä¿å­˜ã—ã¦ãŠã„ã¦ã€**ãƒªã‚¯ã‚¨ã‚¹ãƒˆã”ã¨ã«æ–°ã—ã„ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½œã‚‹**ãŸã‚ã«ä½¿ã„ã¾ã™ã€‚

```go
func (c *NoteController) Create(ctx echo.Context) error {
    // 1. ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ã‘å–ã‚‹
    var body openapi.ModelsCreateNoteRequest
    ctx.Bind(&body)

    // 2. Factoryã‚’å‘¼ã‚“ã§ã€ã“ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆå°‚ç”¨ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½œã‚‹
    input, presenter := c.newIO()

    // 3. UseCaseã‚’å®Ÿè¡Œ
    err := input.Create(ctx.Request().Context(), ...)

    // 4. Presenterã‹ã‚‰çµæœã‚’å–å¾—
    return ctx.JSON(200, presenter.Note())
}

func (c *NoteController) newIO() (port.NoteInputPort, *presenter.NotePresenter) {
    // ã“ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆå°‚ç”¨ã®Presenterã‚’ä½œã‚‹
    output := c.outputFactory()

    // ã“ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆå°‚ç”¨ã®UseCaseã‚’ä½œã‚‹ï¼ˆPresenterã‚’æ¸¡ã™ï¼‰
    input := c.inputFactory(
        c.noteRepoFactory(),
        c.tplRepoFactory(),
        c.txFactory(),
        output,  // â† Presenterã‚’æ³¨å…¥
    )

    return input, output
}
```

**ãªãœãƒªã‚¯ã‚¨ã‚¹ãƒˆã”ã¨ã«æ–°ã—ã„ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ï¼Ÿ**

â†’ **Presenter ã¯çµæœã‚’ä¿å­˜ã™ã‚‹ã‹ã‚‰**

```go
type NotePresenter struct {
    note *openapi.ModelsNoteResponse  // â† ã“ã“ã«çµæœã‚’ä¿å­˜
}

// UseCase ãŒã“ã‚Œã‚’å‘¼ã¶
func (p *NotePresenter) PresentNote(ctx context.Context, n *note.WithMeta) error {
    resp := toNoteResponse(*n)
    p.note = &resp  // â† çµæœã‚’ä¿å­˜
    return nil
}

// Controller ãŒã“ã‚Œã‚’å‘¼ã¶
func (p *NotePresenter) Note() *openapi.ModelsNoteResponse {
    return p.note  // â† ä¿å­˜ã—ãŸçµæœã‚’è¿”ã™
}
```

ã‚‚ã—**1ã¤ã®Presenterã‚’è¤‡æ•°ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§å…±æœ‰**ã—ãŸã‚‰...

```
ãƒªã‚¯ã‚¨ã‚¹ãƒˆ1: ãƒãƒ¼ãƒˆAã‚’å–å¾— â†’ Presenter.note = ãƒãƒ¼ãƒˆA
ãƒªã‚¯ã‚¨ã‚¹ãƒˆ2: ãƒãƒ¼ãƒˆBã‚’å–å¾— â†’ Presenter.note = ãƒãƒ¼ãƒˆB
ãƒªã‚¯ã‚¨ã‚¹ãƒˆ1: çµæœã‚’è¿”ã™ â†’ âŒ ãƒãƒ¼ãƒˆBãŒè¿”ã£ã¦ãã‚‹ï¼ãƒã‚°ï¼
```

**ã ã‹ã‚‰ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã”ã¨ã«æ–°ã—ã„Presenterã‚’ä½œã‚‹å¿…è¦ãŒã‚ã‚‹ï¼**

---

#### ğŸ” ã¾ã¨ã‚: Factoryãƒ‘ã‚¿ãƒ¼ãƒ³ã®3ã¤ã®ãƒ¡ãƒªãƒƒãƒˆ

```
1ï¸âƒ£ ãƒ†ã‚¹ãƒˆã—ã‚„ã™ã„
   â†’ Mockã‚’ã‚µã‚¯ãƒƒã¨æ³¨å…¥

2ï¸âƒ£ æŸ”è»Ÿæ€§ãŒé«˜ã„
   â†’ æœ¬ç•ª/ãƒ†ã‚¹ãƒˆ/MySQL/PostgreSQL...ç°¡å˜ã«åˆ‡ã‚Šæ›¿ãˆ

3ï¸âƒ£ ãƒªã‚¯ã‚¨ã‚¹ãƒˆã”ã¨ã«æ–°ã—ã„ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹
   â†’ Presenterã®çµæœãŒæ··ã–ã‚‰ãªã„
```

**çµè«–:**

```
Factory = ã€Œè¨­è¨ˆå›³ã€ã‚’ä¿å­˜ã—ã¦ãŠã„ã¦ã€å¿…è¦ãªã¨ãã«æ–°ã—ã„ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½œã‚‹ä»•çµ„ã¿

âŒ ç›´æ¥ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ– â†’ ãƒ†ã‚¹ãƒˆã§ããªã„ã€å¤‰æ›´ã«å¼±ã„
âœ… Factory â†’ ãƒ†ã‚¹ãƒˆç°¡å˜ã€æŸ”è»Ÿã€å®‰å…¨
```

---

### Q7: ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã¯ã©ã“ã§å§‹ã‚ã‚‹ï¼Ÿ

**A:** **UseCase ã§é–‹å§‹**ã—ã¾ã™ã€‚

```go
func (u *NoteInteractor) Create(ctx context.Context, input port.NoteCreateInput) error {
    // âœ… UseCaseã§ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³é–‹å§‹
    err := u.tx.WithinTransaction(ctx, func(txCtx context.Context) error {
        // ã“ã®ä¸­ã§è¤‡æ•°ã®Repositoryã‚’å‘¼ã¶
        note, err := u.notes.Create(txCtx, ...)
        if err != nil {
            return err  // è‡ªå‹•ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯
        }

        err = u.notes.ReplaceSections(txCtx, ...)
        if err != nil {
            return err  // è‡ªå‹•ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯
        }

        return nil  // æ­£å¸¸çµ‚äº† â†’ ã‚³ãƒŸãƒƒãƒˆ
    })
    return err
}
```

**ãªãœï¼Ÿ**
- **ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã®å¢ƒç•Œ = ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã®å¢ƒç•Œ**
- Repositoryã¯ã€Œãƒ‡ãƒ¼ã‚¿ã‚’å–ã‚‹ãƒ»ä¿å­˜ã™ã‚‹ã€ã ã‘ã«é›†ä¸­

---

### Q8: ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¯ã©ã†ã™ã‚‹ï¼Ÿ

```
ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¨ãƒ©ãƒ¼ (internal/domain/errors/)
    â†“
ErrNotFound, ErrUnauthorized, ErrTitleRequired...
    â†“
Controller (handleErroré–¢æ•°)
    â†“
HTTPã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã«å¤‰æ›
    â†“
404 Not Found, 401 Unauthorized, 400 Bad Request
```

**é‡è¦:** Gatewayã§**DBã‚¨ãƒ©ãƒ¼ â†’ ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¨ãƒ©ãƒ¼**ã«å¤‰æ›ã™ã‚‹ï¼

```go
// âŒ NG: pgx.ErrNoRowsã‚’ãã®ã¾ã¾è¿”ã™
if err != nil {
    return nil, err
}

// âœ… OK: ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¨ãƒ©ãƒ¼ã«å¤‰æ›
if errors.Is(err, pgx.ErrNoRows) {
    return nil, domainerr.ErrNotFound
}
```

---

## ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ: ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãå‰ã«

æ–°ã—ã„æ©Ÿèƒ½ã‚’è¿½åŠ ã™ã‚‹å‰ã«ã€ã“ã®ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆã‚’ç¢ºèªã—ã‚ˆã†ï¼

### âœ… Domainå±¤

- [ ] ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚„å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«**ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã®å‹**ã‚’ä½¿ã£ã¦ã„ãªã„ã‹ï¼Ÿ
- [ ] ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«ï¼ˆæ¤œè¨¼ã€çŠ¶æ…‹é·ç§»ï¼‰ã‚’**ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤**ã«æ›¸ã„ã¦ã„ã‚‹ã‹ï¼Ÿ
- [ ] `import "github.com/..."` ãªã©ã®å¤–éƒ¨ä¾å­˜ãŒãªã„ã‹ï¼Ÿ

### âœ… UseCaseå±¤

- [ ] Portï¼ˆã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ï¼‰çµŒç”±ã§ä¾å­˜ã—ã¦ã„ã‚‹ã‹ï¼Ÿ
- [ ] å…·ä½“çš„ãªå®Ÿè£…ï¼ˆ`&db.Repository{}`ï¼‰ã«ä¾å­˜ã—ã¦ã„ãªã„ã‹ï¼Ÿ
- [ ] ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å¢ƒç•Œã‚’é©åˆ‡ã«æ±ºã‚ã¦ã„ã‚‹ã‹ï¼Ÿ
- [ ] 1ãƒ¡ã‚½ãƒƒãƒ‰ = 1ä»•äº‹ã«ãªã£ã¦ã„ã‚‹ã‹ï¼Ÿ

### âœ… Controllerå±¤

- [ ] HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆ â†’ ãƒ‰ãƒ¡ã‚¤ãƒ³DTOã«å¤‰æ›ã—ã¦ã„ã‚‹ã‹ï¼Ÿ
- [ ] UseCaseã‚’å‘¼ã‚“ã§ã€Presenterã‹ã‚‰çµæœã‚’å–å¾—ã—ã¦ã„ã‚‹ã‹ï¼Ÿ
- [ ] ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã‚’æ›¸ã„ã¦ã„ãªã„ã‹ï¼Ÿï¼ˆUseCaseã«æ›¸ãï¼‰

### âœ… Presenterå±¤

- [ ] ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ« â†’ OpenAPIå‹ã«å¤‰æ›ã—ã¦ã„ã‚‹ã‹ï¼Ÿ
- [ ] çµæœã‚’å†…éƒ¨ã§ä¿å­˜ã—ã¦ã€ControllerãŒå–ã‚Šå‡ºã›ã‚‹ã‚ˆã†ã«ã—ã¦ã„ã‚‹ã‹ï¼Ÿ

### âœ… Gatewayå±¤

- [ ] DBè¡Œ â†’ ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã«å¤‰æ›ã—ã¦ã„ã‚‹ã‹ï¼Ÿ
- [ ] DBã‚¨ãƒ©ãƒ¼ â†’ ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¨ãƒ©ãƒ¼ã«å¤‰æ›ã—ã¦ã„ã‚‹ã‹ï¼Ÿ
- [ ] `pgtype.UUID` â†’ `string` ãªã©ã®å‹å¤‰æ›ã‚’ã—ã¦ã„ã‚‹ã‹ï¼Ÿ

### âœ… Portå±¤

- [ ] InputPort, OutputPort, Repositoryã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’å®šç¾©ã—ã¦ã„ã‚‹ã‹ï¼Ÿ
- [ ] å…¥åŠ›DTOã‚’å®šç¾©ã—ã¦ã„ã‚‹ã‹ï¼Ÿ

---

## ã¾ã¨ã‚: ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®æœ¬è³ª

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®æœ¬è³ª                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                              â”‚
â”‚  1. ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«ã‚’ä¸­å¿ƒã«ç½®ã                â”‚
â”‚     â†’ DomainãŒä¸€ç•ªå¤§äº‹                       â”‚
â”‚                                              â”‚
â”‚  2. å¤–éƒ¨ï¼ˆDBã€HTTPï¼‰ã¯äº¤æ›å¯èƒ½ã«ã™ã‚‹          â”‚
â”‚     â†’ PortçµŒç”±ã§ä¾å­˜                         â”‚
â”‚                                              â”‚
â”‚  3. ä¾å­˜ã®æ–¹å‘ã‚’å†…å‘ãã«çµ±ä¸€                  â”‚
â”‚     â†’ å¤–å´ã¯å†…å´ã‚’çŸ¥ã‚‹ã€é€†ã¯ãƒ€ãƒ¡              â”‚
â”‚                                              â”‚
â”‚  4. ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã¯å„ãƒ¬ã‚¤ãƒ¤ãƒ¼ã§å¤‰æ›              â”‚
â”‚     â†’ OpenAPIå‹ã€Domainå‹ã€DBå‹ã¯åˆ¥ç‰©         â”‚
â”‚                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æœ€å¾Œã«

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’èª­ã‚“ã ã‚ãªãŸã¯ã€ã‚‚ã†ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£åˆå¿ƒè€…ã§ã¯ã‚ã‚Šã¾ã›ã‚“ï¼

**æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—:**

1. **å®Ÿéš›ã«ã‚³ãƒ¼ãƒ‰ã‚’èª­ã‚€** - `internal/domain/note/` ã‹ã‚‰å§‹ã‚ã‚ˆã†
2. **ãƒ†ã‚¹ãƒˆã‚’æ›¸ã„ã¦ã¿ã‚‹** - Mockã‚’ä½¿ã£ã¦UseCaseã‚’ãƒ†ã‚¹ãƒˆ
3. **å°ã•ãªæ©Ÿèƒ½ã‚’è¿½åŠ ** - ã€Œãƒãƒ¼ãƒˆã«ã‚¿ã‚°ã‚’ã¤ã‘ã‚‹ã€ã¨ã‹
4. **ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°** - æ—¢å­˜ã®ã‚³ãƒ¼ãƒ‰ã‚’æ”¹å–„ã—ã¦ã¿ã‚‹

**è¿·ã£ãŸã‚‰:**
- ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«æˆ»ã£ã¦ãã‚‹
- æ—¢å­˜ã®ã‚³ãƒ¼ãƒ‰ã‚’çœŸä¼¼ã‚‹ï¼ˆ`note`ã‚’å‚è€ƒã«ã™ã‚‹ï¼‰
- 3ã¤ã®ãƒ«ãƒ¼ãƒ«ã‚’æ€ã„å‡ºã™

Happy Coding! ğŸš€

---

## ä»˜éŒ²: ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆã®å…¨ä½“åƒ

```
backend-clean/
â”œâ”€â”€ cmd/
â”‚   â””â”€â”€ api/
â”‚       â””â”€â”€ main.go                      # ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
â”‚
â”œâ”€â”€ internal/
â”‚   â”œâ”€â”€ domain/                          # â¤ï¸ ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«
â”‚   â”‚   â”œâ”€â”€ note/
â”‚   â”‚   â”‚   â”œâ”€â”€ entity.go                # Note, Section
â”‚   â”‚   â”‚   â”œâ”€â”€ types.go                 # NoteStatus
â”‚   â”‚   â”‚   â”œâ”€â”€ logic.go                 # æ¤œè¨¼ãƒ­ã‚¸ãƒƒã‚¯
â”‚   â”‚   â”‚   â”œâ”€â”€ aggregate.go             # WithMeta
â”‚   â”‚   â”‚   â””â”€â”€ *_test.go
â”‚   â”‚   â”œâ”€â”€ template/
â”‚   â”‚   â”œâ”€â”€ account/
â”‚   â”‚   â”œâ”€â”€ service/                     # ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚µãƒ¼ãƒ“ã‚¹
â”‚   â”‚   â”‚   â”œâ”€â”€ note_lifecycle.go        # BuildNote
â”‚   â”‚   â”‚   â”œâ”€â”€ status_transition.go     # CanPublish
â”‚   â”‚   â”‚   â””â”€â”€ build_sections_from_template.go
â”‚   â”‚   â””â”€â”€ errors/
â”‚   â”‚       â””â”€â”€ errors.go                # ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¨ãƒ©ãƒ¼å®šç¾©
â”‚   â”‚
â”‚   â”œâ”€â”€ usecase/                         # ğŸ¯ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ­ã‚¸ãƒƒã‚¯
â”‚   â”‚   â”œâ”€â”€ note_interactor.go
â”‚   â”‚   â”œâ”€â”€ template_interactor.go
â”‚   â”‚   â”œâ”€â”€ account_interactor.go
â”‚   â”‚   â””â”€â”€ mock/
â”‚   â”‚
â”‚   â”œâ”€â”€ port/                            # ğŸ“ ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
â”‚   â”‚   â”œâ”€â”€ note_port.go
â”‚   â”‚   â”œâ”€â”€ template_port.go
â”‚   â”‚   â”œâ”€â”€ account_port.go
â”‚   â”‚   â””â”€â”€ tx.go
â”‚   â”‚
â”‚   â”œâ”€â”€ adapter/                         # ğŸ”Œ å¤–éƒ¨ã¨ã®æ¥ç¶š
â”‚   â”‚   â”œâ”€â”€ http/
â”‚   â”‚   â”‚   â”œâ”€â”€ controller/              # HTTPãƒãƒ³ãƒ‰ãƒ©
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ note_controller.go
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ template_controller.go
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ account_controller.go
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ server.go            # ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ mock/
â”‚   â”‚   â”‚   â”œâ”€â”€ presenter/               # ãƒ¬ã‚¹ãƒãƒ³ã‚¹å¤‰æ›
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ note_presenter.go
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ template_presenter.go
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ account_presenter.go
â”‚   â”‚   â”‚   â””â”€â”€ generated/
â”‚   â”‚   â”‚       â””â”€â”€ openapi/             # OpenAPIç”Ÿæˆç‰©
â”‚   â”‚   â”‚           â””â”€â”€ server.gen.go
â”‚   â”‚   â””â”€â”€ gateway/
â”‚   â”‚       â”œâ”€â”€ db/                      # DB Repository
â”‚   â”‚       â”‚   â”œâ”€â”€ note_repository.go
â”‚   â”‚       â”‚   â”œâ”€â”€ template_repository.go
â”‚   â”‚       â”‚   â”œâ”€â”€ account_repository.go
â”‚   â”‚       â”‚   â”œâ”€â”€ sqlc/                # sqlcç”Ÿæˆç‰©
â”‚   â”‚       â”‚   â”œâ”€â”€ queries/             # SQLã‚¯ã‚¨ãƒª
â”‚   â”‚       â”‚   â””â”€â”€ mock/
â”‚   â”‚       â””â”€â”€ externalapi/             # å¤–éƒ¨API (å°†æ¥ç”¨)
â”‚   â”‚
â”‚   â””â”€â”€ driver/                          # ğŸ”§ é…ç·šãƒ»åˆæœŸåŒ–
â”‚       â”œâ”€â”€ config/                      # è¨­å®š
â”‚       â”œâ”€â”€ db/                          # DBæ¥ç¶š
â”‚       â”‚   â”œâ”€â”€ pool.go
â”‚       â”‚   â””â”€â”€ tx.go
â”‚       â”œâ”€â”€ factory/                     # Factoryé–¢æ•°
â”‚       â”‚   â”œâ”€â”€ usecase_factory.go
â”‚       â”‚   â”œâ”€â”€ presenter_factory.go
â”‚       â”‚   â”œâ”€â”€ repository_factory.go
â”‚       â”‚   â””â”€â”€ tx_factory.go
â”‚       â””â”€â”€ initializer/
â”‚           â””â”€â”€ api/
â”‚               â””â”€â”€ initializer.go       # å…¨ä½“ã®çµ„ã¿ç«‹ã¦
â”‚
â”œâ”€â”€ migrations/                          # DBãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
â”œâ”€â”€ docs/                                # ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
â””â”€â”€ tests/                               # E2Eãƒ†ã‚¹ãƒˆ (å°†æ¥ç”¨)
```

---

## ä»˜éŒ²: ä¾å­˜é–¢ä¿‚ã®å›³

```
ä¾å­˜ã®æ–¹å‘: â†’ (çŸ¥ã£ã¦OK)

              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚    Cmd      â”‚ ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
              â”‚  (main.go)  â”‚
              â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â†“
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚   Driver    â”‚ é…ç·šãƒ»åˆæœŸåŒ–
              â”‚ (Factory,   â”‚
              â”‚  Config)    â”‚
              â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â†“           â†“           â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚Controllerâ”‚ â”‚ Gateway â”‚ â”‚Presenterâ”‚ Adapterå±¤
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
         â”‚           â”‚           â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚   UseCase   â”‚ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤
              â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â†“           â†“           â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Port   â”‚ â”‚ Domain  â”‚ â”‚ Service â”‚ ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤
    â”‚Interfaceâ”‚ â”‚ (Entity)â”‚ â”‚(Domain) â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†‘
         â”‚ (å®Ÿè£…)
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Gateway/Presenterâ”‚
    â”‚  (Adapterå±¤)     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**é‡è¦:**
- çŸ¢å°ã¯ã€Œä¾å­˜ã—ã¦OKã€ã®æ–¹å‘
- **å†…å´ï¼ˆDomainï¼‰ã¯å¤–å´ã‚’çŸ¥ã‚‰ãªã„**
- **Portï¼ˆInterfaceï¼‰ã§ä¾å­˜ã‚’é€†è»¢**

---

**ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãŒã‚ãªãŸã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å­¦ç¿’ã®åŠ©ã‘ã«ãªã‚Šã¾ã™ã‚ˆã†ã«ï¼** ğŸ“
